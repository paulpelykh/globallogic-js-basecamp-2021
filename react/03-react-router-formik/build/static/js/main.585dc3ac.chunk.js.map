{"version":3,"sources":["constants.js","api/utisl.js","api/userApi/index.js","components/Users/constants.js","components/Users/UsersTable/Actions/index.jsx","components/Users/UsersTable/index.jsx","common/Formik/Input/index.jsx","components/Users/UserForm/FormContainer/Buttons/index.jsx","components/Users/UserForm/FormContainer/index.jsx","components/Users/UserForm/index.jsx","components/Users/UserForm/converter.js","components/Users/index.jsx","components/App/index.jsx","components/Root/index.jsx","index.js"],"names":["MODE","wait","ms","Promise","resolve","setTimeout","getTimestamp","Date","now","throwError","id","Error","getId","data","length","api","getUsers","getUser","user","find","u","createUser","newUser","timestamp","push","editUser","index","findIndex","deleteUser","splice","getRoles","USERNAME","ROLE","INITIAL_STATE","Actions","url","useRouteMatch","history","useHistory","redirect","mode","className","onClick","UsersTable","users","setUsers","useEffect","userApi","then","to","map","Input","name","label","validate","type","disabled","useField","field","component","Buttons","isSubmitting","useFormikContext","FormContainer","initialValues","onSubmit","roles","value","includes","join","UserForm","useParams","Number","prevUsers","catch","err","window","alert","message","useState","setRoles","handleSubmit","values","a","payload","getInitialValues","Users","path","exact","App","from","Root","children","basename","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.585dc3ac.chunk.js","sourcesContent":["export const MODE = {\n  VIEW: 'view',\n  CREATE: 'create',\n  EDIT: 'edit',\n};\n","export const wait = (ms = 800) =>\n  new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n\nexport const getTimestamp = () => Date.now();\n\nexport const throwError = id => {\n  throw new Error(`Record with ID ${id} does not exist`);\n};\n","import { wait, getTimestamp, throwError } from '../utisl';\nimport data from './db';\n\nconst getId = (\n  (id = data.length) =>\n  () =>\n    ++id\n)();\n\nconst api = {\n  // GET /users\n  async getUsers() {\n    await wait(1000);\n\n    return data;\n  },\n  // GET /users/:id\n  async getUser(id) {\n    await wait();\n\n    const user = data.find(u => u.id === id);\n\n    if (user) {\n      return user;\n    } else {\n      throwError(id);\n    }\n  },\n  // POST /users\n  async createUser(user) {\n    await wait();\n\n    const newUser = {\n      ...user,\n      id: getId(),\n      timestamp: getTimestamp(),\n    };\n\n    data.push(newUser);\n\n    return newUser;\n  },\n  // PUT /users\n  async editUser(user) {\n    await wait();\n\n    const index = data.findIndex(u => u.id === user.id);\n\n    if (~index) {\n      data[index] = {\n        ...user,\n        timestamp: getTimestamp(),\n      };\n    } else {\n      throwError(user.id);\n    }\n\n    return data[index];\n  },\n  // DELETE /users\n  async deleteUser(user) {\n    await wait();\n\n    const index = data.findIndex(u => u === user.id);\n\n    if (~index) {\n      return data.splice(index, 1);\n    } else {\n      throwError(user.id);\n    }\n  },\n  // GET /roles\n  async getRoles() {\n    await wait();\n\n    return ['user', 'super-user', 'admin'];\n  },\n};\n\nexport default api;\n","export const ID = 'id';\nexport const USERNAME = 'username';\nexport const ROLE = 'role';\nexport const TIMESTAMP = 'timestamp';\n\nexport const INITIAL_STATE = {\n  [USERNAME]: '',\n  [ROLE]: '',\n};\n","import { useRouteMatch, useHistory } from 'react-router-dom';\n\nimport { MODE } from '../../../../constants';\n\nfunction Actions({ id }) {\n  const { url } = useRouteMatch();\n  const history = useHistory();\n\n  const redirect = mode => () => {\n    history.push(`${url}/user/${mode}/${id}`);\n  };\n\n  return (\n    <div className=\"Actions\">\n      <button onClick={redirect(MODE.VIEW)}>View</button>{' '}\n      <button onClick={redirect(MODE.EDIT)}>Edit</button>\n    </div>\n  );\n}\n\nexport default Actions;\n","import { useEffect } from 'react';\nimport { useRouteMatch, Link } from 'react-router-dom';\n\nimport userApi from '../../../api/userApi';\nimport { MODE } from '../../../constants';\nimport { ID, USERNAME, ROLE, TIMESTAMP } from '../constants';\nimport Actions from './Actions';\nimport './index.scss';\n\nfunction UsersTable({ users, setUsers }) {\n  const { url } = useRouteMatch();\n\n  useEffect(() => {\n    userApi.getUsers().then(setUsers);\n  }, [setUsers]);\n\n  return (\n    <div className=\"UsersTable\">\n      <Link to={`${url}/user/${MODE.CREATE}`}>Create User</Link>\n\n      <table>\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>Username</th>\n            <th>Role</th>\n            <th>Last Updated At</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {users.map(user => (\n            <tr key={user[ID]}>\n              <td>{user[ID]}</td>\n              <td>{user[USERNAME]}</td>\n              <td>{user[ROLE]}</td>\n              <td>{user[TIMESTAMP]}</td>\n              <td>\n                <Actions id={user[ID]} />\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default UsersTable;\n","import { useField, ErrorMessage } from 'formik';\n\nimport './styles.scss';\n\nfunction Input({ name, label, validate, type = 'text', disabled = false }) {\n  const [field] = useField({ name, validate });\n\n  return (\n    <div className=\"Input\">\n      <label>\n        <div>{label}</div>\n        <input type={type} disabled={disabled} {...field} />\n      </label>\n\n      <ErrorMessage name={name} className=\"error\" component=\"div\" />\n    </div>\n  );\n}\n\nexport default Input;\n","import { useHistory } from 'react-router-dom';\nimport { useFormikContext } from 'formik';\n\nimport { MODE } from '../../../../../constants';\n\nfunction Buttons({ mode }) {\n  const history = useHistory();\n  const { isSubmitting } = useFormikContext();\n\n  return (\n    <div>\n      {(mode === MODE.CREATE || mode === MODE.EDIT) && (\n        <button type=\"submit\" disabled={isSubmitting}>\n          Save\n        </button>\n      )}\n\n      <button type=\"button\" onClick={() => history.push('/users')}>\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default Buttons;\n","import { Formik, Form } from 'formik';\n\nimport Input from '../../../../common/Formik/Input';\nimport { MODE } from '../../../../constants';\nimport { ROLE, USERNAME } from '../../constants';\nimport Buttons from './Buttons';\n\nfunction FormContainer({ initialValues, onSubmit, mode, roles }) {\n  return (\n    <Formik initialValues={initialValues} onSubmit={onSubmit}>\n      <Form>\n        <Input name={USERNAME} label=\"Username\" disabled={mode === MODE.VIEW} />\n\n        <Input\n          name={ROLE}\n          label=\"Role\"\n          disabled={mode === MODE.VIEW}\n          validate={value => {\n            if (!roles.includes(value)) {\n              return `Allowed roles: ${roles.join(', ')}`;\n            }\n          }}\n        />\n\n        <br />\n\n        <Buttons mode={mode} />\n      </Form>\n    </Formik>\n  );\n}\n\nexport default FormContainer;\n","import { useEffect, useState } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\n\nimport userApi from '../../../api/userApi';\nimport { MODE } from '../../../constants';\nimport { ID } from '../constants';\nimport FormContainer from './FormContainer';\nimport { getInitialValues, getRequestPayload } from './converter';\n\nfunction UserForm({ users, setUsers }) {\n  const { mode, id } = useParams();\n  const history = useHistory();\n\n  const user = users.find(user => user.id === Number(id));\n\n  useEffect(() => {\n    if (mode === MODE.VIEW || mode === MODE.EDIT) {\n      if (!user) {\n        userApi\n          .getUser(Number(id))\n          .then(user => setUsers(prevUsers => [...prevUsers, user]))\n          .catch(err => window.alert(err.message));\n      }\n    }\n  }, [id, mode, user, setUsers]);\n\n  const [roles, setRoles] = useState([]);\n  useEffect(() => {\n    userApi.getRoles().then(setRoles);\n  }, [setUsers]);\n\n  const handleSubmit = async values => {\n    try {\n      const payload = getRequestPayload(values);\n\n      switch (mode) {\n        case MODE.CREATE:\n          await userApi.createUser(payload);\n          break;\n        case MODE.EDIT:\n          await userApi.editUser(payload);\n          break;\n        default:\n          throw Error(`Failed to execute this request for ${mode} mode`);\n      }\n    } catch (err) {\n      window.alert(err.message);\n    }\n\n    history.push('/users');\n  };\n\n  const initialValues = getInitialValues(user);\n\n  return (\n    <FormContainer\n      key={`${mode}:${initialValues[ID]}`}\n      initialValues={initialValues}\n      onSubmit={handleSubmit}\n      mode={mode}\n      roles={roles}\n    />\n  );\n}\n\nexport default UserForm;\n","import { INITIAL_STATE } from '../constants';\n\nexport const getInitialValues = user => (user ? user : INITIAL_STATE);\n\nexport const getRequestPayload = values => values;\n","import { useState } from 'react';\nimport { Switch, Route, useRouteMatch } from 'react-router-dom';\n\nimport { MODE } from '../../constants';\nimport UsersTable from './UsersTable';\nimport UserForm from './UserForm';\n\nfunction Users() {\n  const { path } = useRouteMatch();\n  const [users, setUsers] = useState([]);\n\n  return (\n    <div className=\"App\">\n      <Switch>\n        <Route exact path={path}>\n          <UsersTable users={users} setUsers={setUsers} />\n        </Route>\n\n        <Route exact path={`${path}/user/:mode(${MODE.VIEW}|${MODE.CREATE}|${MODE.EDIT})/:id?`}>\n          <UserForm users={users} setUsers={setUsers} />\n        </Route>\n      </Switch>\n    </div>\n  );\n}\n\nexport default Users;\n","import { Switch, Route, Redirect } from 'react-router-dom';\n\nimport Users from '../Users';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Switch>\n        <Redirect exact from=\"/\" to=\"/users\" />\n\n        <Route path=\"/users\">\n          <Users />\n        </Route>\n      </Switch>\n    </div>\n  );\n}\n\nexport default App;\n","import { BrowserRouter as Router } from 'react-router-dom';\n\nfunction Root({ children }) {\n  return (\n    <Router basename=\"/globallogic-js-basecamp-2021/react/03-react-router-formik/build\">\n      {children}\n    </Router>\n  );\n}\n\nexport default Root;\n","import { StrictMode } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './components/App';\nimport Root from './components/Root';\nimport './styles.css';\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(\n  <StrictMode>\n    <Root>\n      <App />\n    </Root>\n  </StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}